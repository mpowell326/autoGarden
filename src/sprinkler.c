/*!
*   \sprinkler.c
*
*   Purpose:            Control the use of the sprinkler
*
*   Created:            01/11/2017  Morgan Powell
*   Last Modified:
*
*/

/*-----------------------------------------------------------------------------------------------*/
/* Includes                                                                                      */
/*-----------------------------------------------------------------------------------------------*/
/* Standard includes. */
#include <stdio.h>

/* Scheduler includes. */
#include "FreeRTOS.h"
#include "task.h"
#include "queue.h"
#include "semphr.h"

/* Hardware library includes. */
#include "hw_memmap.h"
#include "hw_types.h"
#include "hw_sysctl.h"
#include "hw_timer.h"
#include "hw_ints.h"
#include "timer.h"
#include "sysctl.h"
#include "gpio.h"
#include "grlib.h"
#include "rit128x96x4.h"
#include "adc.h"
#include "interrupt.h"

/* My app includes. */

/*-----------------------------------------------------------------------------------------------*/
/* Defines                                                                                       */
/*-----------------------------------------------------------------------------------------------*/
#define SPRINKLER_GPIO_BASE 'A'
#define SPRINKLER_PIN       GPIO_PIN_3
/*-----------------------------------------------------------------------------------------------*/
/* Macros                                                                                        */
/*-----------------------------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------------------------*/
/* Types                                                                                         */
/*-----------------------------------------------------------------------------------------------*/


/*-----------------------------------------------------------------------------------------------*/
/* Function Prototypes                                                                           */
/*-----------------------------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------------------------*/
/* Constants                                                                                     */
/*-----------------------------------------------------------------------------------------------*/


/*-----------------------------------------------------------------------------------------------*/
/* Variables                                                                                     */
/*-----------------------------------------------------------------------------------------------*/
static xSemaphoreHandle xSprinklerReady;

/*===============================================================================================*/
/*===============================================================================================*/
/*===============================================================================================*/
/* Implementation                                                                                */
/*===============================================================================================*/
/*===============================================================================================*/
/*===============================================================================================*/

/*-----------------------------------------------------------------------------------------------*/
/* Private Functions:					                                                         */
/*-----------------------------------------------------------------------------------------------*/



/*-----------------------------------------------------------------------------------------------*/
/* Public Functions                                                                              */
/*-----------------------------------------------------------------------------------------------*/
void sprinkler_Initialise()
{
    // Enable the port A Peripheral
    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOA);
    //Set Pin on port A base as an output
    GPIOPinTypeGPIOOutput(GPIO_PORTA_BASE,SPRINKLER_PIN);
    xSemaphoreGive(xSprinklerReady)
}

bool sprinkler_TurnOn()
{
    if( xSemaphoreTake(xSprinklerReady) )
    {
        GPIOPinWrite(GPIO_PORTA_BASE,SPRINKLER_PIN,0xff);
        return true;
    }
    else
    {
        return false;
    }
}

void sprinkler_TurnOff()
{
    GPIOPinWrite(GPIO_PORTA_BASE,SPRINKLER_PIN,0x00);
    xSemaphoreGive(xSprinklerReady)
}


/**************************************************************************************************
*   sprinkler.c
**************************************************************************************************/
